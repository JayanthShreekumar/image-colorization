Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
/opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loading model from: /opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/lpips/weights/v0.1/alex.pth
Starting Training Epoch 1
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:36<00:00,  1.52it/s]
Training: Epoch 1 		 Discriminator Loss: 0.01822655275464058  		 Generator Loss: 0.064356729388237
Validation: Epoch 1 		 Discriminator Loss: 0.15199162194758287  		 Generator Loss: 3.948567190288026
Starting Training Epoch 2
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:36<00:00,  1.53it/s]
Training: Epoch 2 		 Discriminator Loss: 0.009193435311317444  		 Generator Loss: 0.06962756812572479
Validation: Epoch 2 		 Discriminator Loss: 0.05915530301906444  		 Generator Loss: 2.556131080344871
Starting Training Epoch 3
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:36<00:00,  1.51it/s]
Training: Epoch 3 		 Discriminator Loss: 0.010954457335174084  		 Generator Loss: 0.06753524392843246
Validation: Epoch 3 		 Discriminator Loss: 0.06894769491972746  		 Generator Loss: 2.4679905926739725
Starting Training Epoch 4
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:37<00:00,  1.51it/s]
Training: Epoch 4 		 Discriminator Loss: 0.013311263173818588  		 Generator Loss: 0.06107029691338539
Validation: Epoch 4 		 Discriminator Loss: 0.08604495540077303  		 Generator Loss: 2.322678742585359
Starting Training Epoch 5
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:37<00:00,  1.50it/s]
Training: Epoch 5 		 Discriminator Loss: 0.020926253870129585  		 Generator Loss: 0.05050748214125633
Validation: Epoch 5 		 Discriminator Loss: 0.12874710265501046  		 Generator Loss: 2.237343140590338
Starting Training Epoch 6
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:37<00:00,  1.50it/s]
Training: Epoch 6 		 Discriminator Loss: 0.02062823623418808  		 Generator Loss: 0.05372453108429909
Validation: Epoch 6 		 Discriminator Loss: 0.12578993373446995  		 Generator Loss: 2.28473538528254
Starting Training Epoch 7
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:36<00:00,  1.53it/s]
Training: Epoch 7 		 Discriminator Loss: 0.018386803567409515  		 Generator Loss: 0.05267211049795151
Validation: Epoch 7 		 Discriminator Loss: 0.11360895560111528  		 Generator Loss: 2.1822393911856195
Starting Training Epoch 8
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:37<00:00,  1.51it/s]
Training: Epoch 8 		 Discriminator Loss: 0.02045222371816635  		 Generator Loss: 0.057631801813840866
Validation: Epoch 8 		 Discriminator Loss: 0.1256307805026019  		 Generator Loss: 2.3771739771336686
Starting Training Epoch 9
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:36<00:00,  1.52it/s]
Training: Epoch 9 		 Discriminator Loss: 0.020299533382058144  		 Generator Loss: 0.051254477351903915
Validation: Epoch 9 		 Discriminator Loss: 0.11421820116631778  		 Generator Loss: 2.188129778261538
Starting Training Epoch 10
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:37<00:00,  1.51it/s]
Training: Epoch 10 		 Discriminator Loss: 0.019167644903063774  		 Generator Loss: 0.05123550072312355
Validation: Epoch 10 		 Discriminator Loss: 0.12711823575290632  		 Generator Loss: 2.0991422865125866
Starting Training Epoch 11
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:36<00:00,  1.51it/s]
Training: Epoch 11 		 Discriminator Loss: 0.019781066104769707  		 Generator Loss: 0.05855879932641983
Validation: Epoch 11 		 Discriminator Loss: 0.13410199718710816  		 Generator Loss: 2.185381171144085
Starting Training Epoch 12
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:35<00:00,  1.58it/s]
Training: Epoch 12 		 Discriminator Loss: 0.023410571739077568  		 Generator Loss: 0.06002797931432724
Validation: Epoch 12 		 Discriminator Loss: 0.137883417400313  		 Generator Loss: 2.3905791058952426
Starting Training Epoch 13
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:37<00:00,  1.50it/s]
Training: Epoch 13 		 Discriminator Loss: 0.020081469789147377  		 Generator Loss: 0.050604723393917084
Traceback (most recent call last):
  File "/home/jovyan/image-colorization/main.py", line 161, in <module>
    trainer.train()
  File "/home/jovyan/image-colorization/GAN/train.py", line 96, in train
    errD_val, errG_val, ssim_val, lpips_val, deltaE_val, val_len = self.validate(model_D, model_G, criterion, L1)
                                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/image-colorization/GAN/train.py", line 159, in validate
    total_deltaE += compute_deltaE(fake, targets) * batch_size
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jovyan/image-colorization/metrics.py", line 29, in compute_deltaE
    t_lab = color.rgb2lab(t)
            ^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/skimage/_shared/utils.py", line 445, in fixed_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/skimage/color/colorconv.py", line 1280, in rgb2lab
    return xyz2lab(rgb2xyz(rgb), illuminant, observer)
                   ^^^^^^^^^^^^
  File "/opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/skimage/_shared/utils.py", line 445, in fixed_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/saturncloud/envs/ece60131_proj/lib/python3.12/site-packages/skimage/color/colorconv.py", line 855, in rgb2xyz
    arr[mask] = np.power((arr[mask] + 0.055) / 1.055, 2.4)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
